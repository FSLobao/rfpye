---

title: Parser


keywords: fastai
sidebar: home_sidebar

summary: "Este módulo lida com o processamento e análise dos metadados e dados do espectro dos blocos"
description: "Este módulo lida com o processamento e análise dos metadados e dados do espectro dos blocos"
nb_path: "nbs\01_parser.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\01_parser.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processamento-do-Arquivo-.bin-e-cria&#231;&#227;o-dos-diferentes-tipos-de-blocos">Processamento do Arquivo <code>.bin</code> e cria&#231;&#227;o dos diferentes tipos de blocos<a class="anchor-link" href="#Processamento-do-Arquivo-.bin-e-cria&#231;&#227;o-dos-diferentes-tipos-de-blocos"> </a></h2><p>A função seguinte <a href="/rfpyeparser.html#parse_bin"><code>parse_bin</code></a> recebe um arquivo <code>.bin</code> e mapeia os blocos contidos nele retornando um dicionário:</p>
<ul>
<li><code>file_version</code>: Versão do arquivo <code>.bin</code></li>
<li><p><code>blocks</code>: Dicionário com os blocos do arquivo <code>.bin</code>. Cada tipo de bloco tem sua Classe Própria</p>
<p>O dicionário <code>blocks</code> retornado tem como chave uma tupla (tipo de bloco, <code>thread_id</code>) e os valores como uma lista com os blocos ( classes ) extraídos sequencialmente.</p>
</li>
</ul>
<p>O tipo de bloco é a natureza do dado contido, por exemplo: 40 - GPS, 67 - Dado Espectral. O <code>thread_id</code> discrimina em geral diferentes "faixas" do mesmo tipo de dado. Para dados espectrais, por exemplo, diferentes thread_id representam varreduras de faixas de frequência distintas</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_bin" class="doc_header"><code>parse_bin</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_bin</code>(<strong><code>bin_file</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>], <strong><code>btypes</code></strong>:<code>Iterable</code>[<code>T_co</code>]=<em><code>dict_keys([6, 21, 24, 40, 41, 42, 51, 63, 64, 65, 66, 67, 68, 69])</code></em>, <strong><code>slice_</code></strong>:<code>slice</code>=<em><code>None</code></em>, <strong><code>bytes_header</code></strong>:<code>int</code>=<em><code>36</code></em>, <strong><code>marker</code></strong>:<code>bytes</code>=<em><code>b'UUUU'</code></em>)</p>
</blockquote>
<p>Receives a CRFS binfile and return a dictionary with its different blocks:</p>
<p>Args:
    bin_file (Union[str, Path]): path to the bin file
    btypes (Iterable, optional): Restrict processing to only these block types. Defaults to MAIN<em>BLOCKS.keys().
    slice</em> (slice, optional): Slice to cut the bin file if desired. Defaults to None.
    bytes_header (int, optional): File Header Size. Defaults to BYTES_HEADER.
    marker (bytes, optional): Byte marker delimiting the end of one block. Defaults to ENDMARKER.</p>
<p>Returns:
    [type]: Dictionary with the bin_file version and dictionary of the different blocks.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A função a seguir recebe os bytes lidos do arquivo <code>.bin</code> e mapeia esses bytes em diferentes classes de acordo com o tipo de bloco</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="classify_blocks" class="doc_header"><code>classify_blocks</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L65" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>classify_blocks</code>(<strong><code>blocks</code></strong>:<code>Iterable</code>[<code>T_co</code>], <strong><code>btypes</code></strong>:<code>Iterable</code>[<code>T_co</code>]=<em><code>dict_keys([6, 21, 24, 40, 41, 42, 51, 63, 64, 65, 66, 67, 68, 69])</code></em>)</p>
</blockquote>
<p>Receives an iterable L with binary blocks and returns a defaultdict with a tuple (block types, thread_id) as keys and a list of the Class Blocks as values
:param file: A string or pathlib.Path like path to a <code>.bin</code>file generated by CFRS - Logger
:return: A Dictionary with block types as keys and a list of the Class Blocks available as values</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extract_level" class="doc_header"><code>extract_level</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extract_level</code>(<strong><code>spectrum_blocks</code></strong>:<code>L</code>, <strong><code>dtype</code></strong>=<em><code>float32</code></em>)</p>
</blockquote>
<p>Receives a mapping <code>spectrum_blocks</code> and returns the Matrix with the Levels as values, Frequencies as columns and Block Number as index.
:param pivoted: If False, optionally returns an unpivoted version of the Matrix</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="meta_from_blocks" class="doc_header"><code>meta_from_blocks</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L156" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>meta_from_blocks</code>(<strong><code>blocks</code></strong>:<code>L</code>, <strong><code>attrs</code></strong>:<code>list</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Receives a list of blocks, extracts the metadata from them and return a DataFrame</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_metadata" class="doc_header"><code>export_metadata</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L198" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_metadata</code>(<strong><code>blocks</code></strong>:<code>dict</code>, <strong><code>filter_attrs</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>dict</code>]=<em><code>None</code></em>, <strong><code>to_save</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>bin_name</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>]=<em><code>None</code></em>, <strong><code>outfolder</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>]=<em><code>None</code></em>, <strong><code>extension</code></strong>:<code>str</code>=<em><code>'.csv'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_level" class="doc_header"><code>export_level</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/parser.py#L255" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_level</code>(<strong><code>stem</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>], <strong><code>blocks</code></strong>:<code>dict</code>, <strong><code>saida</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>], <strong><code>ext</code></strong>:<code>str</code>=<em><code>'.fth'</code></em>, <strong><code>index</code></strong>:<code>DatetimeIndex</code>=<em><code>None</code></em>, <strong><code>dtype</code></strong>:<code>Union</code>[<code>str</code>, <code>dtype</code>]=<em><code>float16</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

