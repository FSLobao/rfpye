---

title: Processamento e Filtragem


keywords: fastai
sidebar: home_sidebar

summary: "Módulo com funções que encapsulam o processamento completo e retorno de estatísticas dos arquivos bin"
description: "Módulo com funções que encapsulam o processamento completo e retorno de estatísticas dos arquivos bin"
nb_path: "nbs\00_filter.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\00_filter.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resumo-Estat&#237;stico">Resumo Estat&#237;stico<a class="anchor-link" href="#Resumo-Estat&#237;stico"> </a></h2><p>A seguinte função recebe um DataFrame cujas linhas são as diferentes varreduras do espectro, cada uma com seu timestamp, e colunas as diferentes frequências centrais medidas. Essa função é chamada pela função <a href="/rfpyefilter.html#extract_bin_stats"><code>extract_bin_stats</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="filter_spectrum" class="doc_header"><code>filter_spectrum</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/filter.py#L39" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>filter_spectrum</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>time_start</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>time_stop</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>freq_start</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>freq_stop</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Recebe o arquivo de espectro df e retorna de acordo com os filtros</p>
<p>Args:
    df (pd.DataFrame): Arquivo de espectro. Timestamp como linhas e frequências como colunas
    time_start (str): Timestamp de início. Se None filtra desde o início do arquivo
    time_stop (str): Timestamp de fim. Se None filtra até o fim do arquivo
    freq_start (str): Filtro inicial de frequência. Se None retorna desde a menor frequências
    freq_stop (str): Filtro Final de frequência. Se None retorna até a maior frequência.</p>
<p>Returns:
    pd.DataFrame: DataFrame com Frequência, min, max e mean após os filtros aplicados.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">filter_spectrum</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">time_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_stop</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">freq_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">freq_stop</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Recebe o arquivo de espectro df e retorna de acordo com os filtros</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Arquivo de espectro. Timestamp como linhas e frequências como colunas</span>
<span class="sd">        time_start (str): Timestamp de início. Se None filtra desde o início do arquivo</span>
<span class="sd">        time_stop (str): Timestamp de fim. Se None filtra até o fim do arquivo</span>
<span class="sd">        freq_start (str): Filtro inicial de frequência. Se None retorna desde a menor frequências</span>
<span class="sd">        freq_stop (str): Filtro Final de frequência. Se None retorna até a maior frequência.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame com Frequência, min, max e mean após os filtros aplicados.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">time_start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="s2">&quot;01/01/2000&quot;</span>
    <span class="k">if</span> <span class="n">time_stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_stop</span> <span class="o">=</span> <span class="s2">&quot;31/12/2100&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time_start</span><span class="p">)</span>
        <span class="n">time_stop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time_stop</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold red blink] Datas inválidas! Verifique as strings de data </span><span class="si">{</span><span class="n">freq_start</span><span class="si">}</span><span class="s2"> e </span><span class="si">{</span><span class="n">freq_stop</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">KeyError</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Não foi passado uma coluna ou índice com datetime a ser filtrado, todas as linhas serão processadas&quot;</span><span class="p">,</span>
                <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">time_start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">time_stop</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">freq_start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">freq_start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">freq_stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">freq_stop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="n">filtered_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[(</span><span class="nb">float</span><span class="p">(</span><span class="n">freq_start</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cols</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cols</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">freq_stop</span><span class="p">))]</span>
    <span class="n">filtered_rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">time_start</span> <span class="o">&lt;=</span> <span class="n">rows</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rows</span> <span class="o">&lt;=</span> <span class="n">time_stop</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">filtered_rows</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filtered_rows</span><span class="p">,</span> <span class="n">filtered_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">filtered_cols</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;Frequency&quot;</span><span class="p">:</span> <span class="n">freq</span><span class="p">,</span> <span class="s2">&quot;Min&quot;</span><span class="p">:</span> <span class="n">min_</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">:</span> <span class="n">max_</span><span class="p">,</span> <span class="s2">&quot;Mean&quot;</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="n">count</span><span class="p">}</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processamento-e-Extra&#231;&#227;o">Processamento e Extra&#231;&#227;o<a class="anchor-link" href="#Processamento-e-Extra&#231;&#227;o"> </a></h2><p>A função a seguir é um wrapper de toda funcionalidade desta biblioteca. Ela recebe o caminho <code>entrada</code> para um arquivo <code>.bin</code> ou pasta contendo vários arquivos <code>.bin</code>, extrai os metadados e os dados de espectro. Mescla o timestamp dos metadados com o arquivo de espectro e salva ambos na pasta <code>saida</code>. Essa pasta é usada como repositório e cache dos dados processados que serão utilizados pela função <a href="/rfpyefilter.html#extract_bin_stats"><code>extract_bin_stats</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_bin" class="doc_header"><code>process_bin</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/filter.py#L122" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_bin</code>(<strong><code>entrada</code></strong>:<code>str</code>, <strong><code>saida</code></strong>:<code>str</code>, <strong><code>recursivo</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>pastas</code></strong>:<code>Iterable</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>levels</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>substituir</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>dtype</code></strong>:<code>str</code>=<em><code>'float16'</code></em>)</p>
</blockquote>
<p>Recebe uma pasta ou arquivo bin, processa e salva os metadados e espectro na saida.</p>
<p>Args:
    entrada (str): Caminho para a Pasta ou Arquivo .bin
    saida (str): Pasta onde salvar os arquivos processados
    recursivo (bool, optional): Buscar os arquivos de entrada recursivamente. Defaults to False.
    pastas (Iterable[str], optional): Limitar a busca a essas pastas. Defaults to None.
    levels (bool, optional): Extrair e salvar os dados de espectro. Defaults to False.
    substituir (bool, optional): Reprocessar arquivos já processados?. Defaults to False.
    dtype (str, optional): Tipo de dados a salvar o espectro. Defaults to "float16".</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_bin</span><span class="p">(</span>
    <span class="n">entrada</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">saida</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">recursivo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pastas</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">substituir</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;float16&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Recebe uma pasta ou arquivo bin, processa e salva os metadados e espectro na saida.</span>

<span class="sd">    Args:</span>
<span class="sd">        entrada (str): Caminho para a Pasta ou Arquivo .bin</span>
<span class="sd">        saida (str): Pasta onde salvar os arquivos processados</span>
<span class="sd">        recursivo (bool, optional): Buscar os arquivos de entrada recursivamente. Defaults to False.</span>
<span class="sd">        pastas (Iterable[str], optional): Limitar a busca a essas pastas. Defaults to None.</span>
<span class="sd">        levels (bool, optional): Extrair e salvar os dados de espectro. Defaults to False.</span>
<span class="sd">        substituir (bool, optional): Reprocessar arquivos já processados?. Defaults to False.</span>
<span class="sd">        dtype (str, optional): Tipo de dados a salvar o espectro. Defaults to &quot;float16&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">entrada</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">entrada</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">entrada</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">lista_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">entrada</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lista_bins</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span>
            <span class="n">entrada</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;.bin&quot;</span><span class="p">],</span> <span class="n">recurse</span><span class="o">=</span><span class="n">recursivo</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="n">pastas</span>
        <span class="p">)</span>
    <span class="n">parsed_bins</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">meta_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">saida</span><span class="si">}</span><span class="s2">/meta&quot;</span><span class="p">)</span>
    <span class="n">levels_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">saida</span><span class="si">}</span><span class="s2">/levels&quot;</span><span class="p">)</span>
    <span class="n">meta_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">levels_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">log_meta</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">saida</span><span class="si">}</span><span class="s2">/log_meta.txt&quot;</span><span class="p">)</span>
    <span class="n">log_levels</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">saida</span><span class="si">}</span><span class="s2">/log_levels.txt&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">substituir</span><span class="p">:</span>
        <span class="n">done_meta</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">done_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="n">done_meta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">log_meta</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">log_meta</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">done_levels</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">log_levels</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">log_levels</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">rule</span><span class="p">(</span><span class="s2">&quot;Lista de Arquivos a serem processados&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
        <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lista_bins</span><span class="p">],</span>
        <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold white&quot;</span><span class="p">,</span>
        <span class="n">overflow</span><span class="o">=</span><span class="s2">&quot;fold&quot;</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lista_bins</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;:sleeping: Nenhum arquivo .bin a processar :zzz:&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">levels</span><span class="p">:</span>
        <span class="n">lista_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lista_bins</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">done_meta</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lista_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lista_bins</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">done_levels</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">lista_bins</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;:sleeping: Nenhum arquivo novo a processar :zzz:&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="s2">&quot;:point_up: use --substituir no terminal ou substituir=True na chamada caso queira reprocessar os bins e sobrepôr os arquivos existentes :wink:&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="k">with</span> <span class="n">Progress</span><span class="p">(</span><span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auto_refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">progress</span><span class="p">:</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">track</span><span class="p">(</span>
                <span class="n">lista_bins</span><span class="p">,</span>
                <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_bins</span><span class="p">),</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[green]Processando Blocos Binários&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[cyan]Processando Blocos de: [red]</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">parsed_bins</span><span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_bin</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

            <span class="n">lista_meta</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parsed_bins</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">done_meta</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">lista_meta</span><span class="p">:</span>
                <span class="n">blocks</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">track</span><span class="p">(</span>
                    <span class="n">lista_meta</span><span class="p">,</span>
                    <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_meta</span><span class="p">),</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[cyan]Exportando Metadados&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
                    <span class="n">progress</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[cyan]Extraindo Metadados de: [red]</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">export_meta</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">meta_path</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;.fth&quot;</span><span class="p">)</span>
                    <span class="n">done_meta</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                    <span class="n">progress</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">levels</span><span class="p">:</span>
                <span class="n">lista_levels</span> <span class="o">=</span> <span class="n">lista_meta</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parsed_bins</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">done_levels</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">lista_levels</span><span class="p">:</span>
                    <span class="n">bins</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">track</span><span class="p">(</span>
                        <span class="n">lista_levels</span><span class="p">,</span>
                        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_levels</span><span class="p">),</span>
                        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[grey]Exportando Dados de Espectro&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">block_obj</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
                        <span class="n">progress</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;[grey]Extraindo Espectro de: [red]</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                        <span class="n">meta_index</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">blocks</span> <span class="o">=</span> <span class="n">block_obj</span><span class="p">[</span><span class="s2">&quot;blocks&quot;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">tipo</span><span class="p">,</span> <span class="n">tid</span><span class="p">)</span> <span class="ow">in</span> <span class="n">blocks</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">tipo</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECTRAL_BLOCKS</span><span class="p">:</span>
                                <span class="k">continue</span>
                            <span class="n">meta_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">meta_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">-B_</span><span class="si">{</span><span class="n">tipo</span><span class="si">}</span><span class="s2">_TId_</span><span class="si">{</span><span class="n">tid</span><span class="si">}</span><span class="s2">.fth&quot;</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">meta_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                                <span class="n">export_meta</span><span class="p">(</span>
                                    <span class="n">file</span><span class="p">,</span>
                                    <span class="n">block_obj</span><span class="p">,</span>
                                    <span class="n">meta_path</span><span class="p">,</span>
                                    <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;.fth&quot;</span><span class="p">,</span>
                                <span class="p">)</span>
                                <span class="n">done_meta</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                            <span class="n">meta_df</span> <span class="o">=</span> <span class="n">read_meta</span><span class="p">(</span><span class="n">meta_file</span><span class="p">)</span>
                            <span class="n">meta_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
                        <span class="n">export_level</span><span class="p">(</span>
                            <span class="n">file</span><span class="p">,</span>
                            <span class="n">block_obj</span><span class="p">,</span>
                            <span class="n">levels_path</span><span class="p">,</span>
                            <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;.fth&quot;</span><span class="p">,</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">meta_index</span><span class="p">,</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">done_levels</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                        <span class="n">progress</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;kbô :satisfied:&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">log_meta</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">done_meta</span><span class="p">))))</span>
        <span class="n">log_levels</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">done_levels</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extrair-dados-estat&#237;sticos">Extrair dados estat&#237;sticos<a class="anchor-link" href="#Extrair-dados-estat&#237;sticos"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A função a seguir é a que será mais comumente chamada por outro módulo que utilizar esta lib. Ela recebe o caminho para um arquivo <code>.bin</code> e retorna um DataFrame com Frequência, Máximo, Mínimo e Média dos dados de Espectro presentes no arquivo <code>.bin</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extract_bin_stats" class="doc_header"><code>extract_bin_stats</code><a href="https://github.com/ronaldokun/rfpye/tree/master/rfpye/filter.py#L279" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extract_bin_stats</code>(<strong><code>filename</code></strong>:<code>str</code>, <strong><code>time_start</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>time_stop</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>freq_start</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>freq_stop</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>cache</code></strong>:<code>str</code>=<em><code>Path('D:/OneDrive - ANATEL/Code/rfpye/.cache')</code></em>)</p>
</blockquote>
<p>Recebe o caminho para um arquivo CRFS bin e retorna um dataframe com o resumo estatístico dos dados de espectro</p>
<p>Args:
    filename (str): Caminho para o arquivo bin
    time_start (str): Timestamp de início. Se None filtra desde o início do arquivo
    time_stop (str): Timestamp de fim. Se None filtra até o fim do arquivo
    freq_start (str): Filtro inicial de frequência. Se None retorna desde a menor frequências
    freq_stop (str): Filtro Final de frequência. Se None retorna até a maior frequência.
    cache (str, optional): Caminho para a pasta de cache. Default é criar uma pasta oculta .cache no diretório atual.</p>
<p>Returns:
    pd.DataFrame: Dataframe contendo o resumo estatístico do arquivo</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">extract_bin_stats</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">time_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_stop</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">freq_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">freq_stop</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cache</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">CACHE_FOLDER</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Recebe o caminho para um arquivo CRFS bin e retorna um dataframe com o resumo estatístico dos dados de espectro</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Caminho para o arquivo bin</span>
<span class="sd">        time_start (str): Timestamp de início. Se None filtra desde o início do arquivo</span>
<span class="sd">        time_stop (str): Timestamp de fim. Se None filtra até o fim do arquivo</span>
<span class="sd">        freq_start (str): Filtro inicial de frequência. Se None retorna desde a menor frequências</span>
<span class="sd">        freq_stop (str): Filtro Final de frequência. Se None retorna até a maior frequência.</span>
<span class="sd">        cache (str, optional): Caminho para a pasta de cache. Default é criar uma pasta oculta .cache no diretório atual.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Dataframe contendo o resumo estatístico do arquivo</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">cached_files</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">cache</span> <span class="o">/</span> <span class="s2">&quot;levels&quot;</span><span class="p">)</span>
        <span class="c1"># TODO filter based on metadata</span>
        <span class="n">cached_levels</span> <span class="o">=</span> <span class="n">cached_files</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="n">filename</span><span class="o">.</span><span class="n">stem</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cached_levels</span><span class="p">:</span>
            <span class="n">process_bin</span><span class="p">(</span><span class="n">entrada</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">saida</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">dfs</span> <span class="o">=</span> <span class="n">cached_levels</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">)</span>
    <span class="n">spectra</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">filter_spectrum</span><span class="p">,</span> <span class="n">time_start</span><span class="o">=</span><span class="n">time_start</span><span class="p">,</span> <span class="n">time_stop</span><span class="o">=</span><span class="n">time_stop</span><span class="p">,</span> <span class="n">freq_start</span><span class="o">=</span><span class="n">freq_start</span><span class="p">,</span> <span class="n">freq_stop</span><span class="o">=</span><span class="n">freq_stop</span><span class="p">)</span>
    <span class="n">spectra</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spectra</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">spectra</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Os parâmetros repassados não correspondem a nenhum dado espectral do arquivo&quot;</span><span class="p">,</span>
            <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>
    <span class="n">spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">spectra</span><span class="p">)</span>
    <span class="n">gb</span> <span class="o">=</span> <span class="n">spectra</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
    <span class="n">out</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spectra</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">out</span><span class="p">[</span><span class="s2">&quot;Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">min</span><span class="p">()[</span><span class="s2">&quot;Min&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">out</span><span class="p">[</span><span class="s2">&quot;Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s2">&quot;Max&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">out</span><span class="p">[</span><span class="s2">&quot;Mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">appended_mean</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Chamada da função somente fornecendo o caminho do arquivo <code>.bin</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">entrada</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\OneDrive - ANATEL\BinFiles&#39;</span><span class="p">)</span>
<span class="n">saida</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\rsilva\Downloads\saida&#39;</span><span class="p">)</span>
<span class="n">binfile</span> <span class="o">=</span> <span class="n">entrada</span> <span class="o">/</span> <span class="s1">&#39;201201_T153421_OneThreadID.bin&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000; font-weight: bold">─────────────────────────── </span>Lista de Arquivos a serem processados<span style="color: #800000; text-decoration-color: #800000; font-weight: bold"> ───────────────────────────</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #c0c0c0; text-decoration-color: #c0c0c0; font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'201201_T153421_OneThreadID.bin'</span><span style="color: #c0c0c0; text-decoration-color: #c0c0c0; font-weight: bold">]                                                           </span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080">Processando Blocos de: </span><span style="color: #800000; text-decoration-color: #800000">201201_T153421_OneThreadID.bin</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080">Extraindo Metadados de: </span><span style="color: #800000; text-decoration-color: #800000">201201_T153421_OneThreadID.bin</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Extraindo Espectro de: <span style="color: #800000; text-decoration-color: #800000">201201_T153421_OneThreadID.bin</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">kbô 😆
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70.000000</td>
      <td>-129.5</td>
      <td>-68.0</td>
      <td>-86.3125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70.019539</td>
      <td>-127.5</td>
      <td>-67.5</td>
      <td>-86.7500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70.039085</td>
      <td>-132.0</td>
      <td>-69.5</td>
      <td>-86.5625</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.058624</td>
      <td>-137.0</td>
      <td>-69.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.078163</td>
      <td>-130.0</td>
      <td>-70.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>109.921837</td>
      <td>-130.5</td>
      <td>-64.0</td>
      <td>-87.1875</td>
    </tr>
    <tr>
      <th>2044</th>
      <td>109.941376</td>
      <td>-125.0</td>
      <td>-61.0</td>
      <td>-83.7500</td>
    </tr>
    <tr>
      <th>2045</th>
      <td>109.960915</td>
      <td>-129.5</td>
      <td>-60.0</td>
      <td>-84.0625</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>109.980461</td>
      <td>-129.0</td>
      <td>-59.5</td>
      <td>-83.2500</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>110.000000</td>
      <td>-131.5</td>
      <td>-60.0</td>
      <td>-82.1875</td>
    </tr>
  </tbody>
</table>
<p>2048 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pela saída do código acima, vemos que o arquivo <code>.bin</code> foi processado, seus metadados e espectro extraídos e salvos. Como não passamos uma pasta de saída uma pasta local <code>.cache</code> é criada e os arquivos são salvos nela. Posteriormente o arquivo de espectro no cache é lido e o resumo estatístico das frequências no tempo é retornado.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Se chamarmos novamente a função com os mesmos argumentos, dessa vez a execução será mais rápida por conta do cache e assim o arquivo <code>.bin</code> não precisa ser processado novamente.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70.000000</td>
      <td>-129.5</td>
      <td>-68.0</td>
      <td>-86.3125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70.019539</td>
      <td>-127.5</td>
      <td>-67.5</td>
      <td>-86.7500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70.039085</td>
      <td>-132.0</td>
      <td>-69.5</td>
      <td>-86.5625</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.058624</td>
      <td>-137.0</td>
      <td>-69.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.078163</td>
      <td>-130.0</td>
      <td>-70.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>109.921837</td>
      <td>-130.5</td>
      <td>-64.0</td>
      <td>-87.1875</td>
    </tr>
    <tr>
      <th>2044</th>
      <td>109.941376</td>
      <td>-125.0</td>
      <td>-61.0</td>
      <td>-83.7500</td>
    </tr>
    <tr>
      <th>2045</th>
      <td>109.960915</td>
      <td>-129.5</td>
      <td>-60.0</td>
      <td>-84.0625</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>109.980461</td>
      <td>-129.0</td>
      <td>-59.5</td>
      <td>-83.2500</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>110.000000</td>
      <td>-131.5</td>
      <td>-60.0</td>
      <td>-82.1875</td>
    </tr>
  </tbody>
</table>
<p>2048 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Vemos que o arquivo possui frequências de 70MHz a 110MHz. Se tivermos interessados em faixas menos, podemos filtrá-las. Por exemplo, vamos filtrar pela faixa de FM somente <code>88 a 108</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">freq_start</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span> <span class="n">freq_stop</span><span class="o">=</span><span class="mi">108</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>88.016609</td>
      <td>-115.0</td>
      <td>-49.0</td>
      <td>-84.1250</td>
    </tr>
    <tr>
      <th>1</th>
      <td>88.036148</td>
      <td>-117.5</td>
      <td>-48.5</td>
      <td>-84.2500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>88.055695</td>
      <td>-118.0</td>
      <td>-49.0</td>
      <td>-84.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>88.075233</td>
      <td>-120.5</td>
      <td>-47.5</td>
      <td>-83.6875</td>
    </tr>
    <tr>
      <th>4</th>
      <td>88.094772</td>
      <td>-120.0</td>
      <td>-47.5</td>
      <td>-83.5625</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1018</th>
      <td>107.909134</td>
      <td>-122.0</td>
      <td>-65.5</td>
      <td>-85.1875</td>
    </tr>
    <tr>
      <th>1019</th>
      <td>107.928673</td>
      <td>-120.0</td>
      <td>-66.5</td>
      <td>-85.3750</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>107.948219</td>
      <td>-126.5</td>
      <td>-67.5</td>
      <td>-85.8125</td>
    </tr>
    <tr>
      <th>1021</th>
      <td>107.967758</td>
      <td>-119.0</td>
      <td>-71.5</td>
      <td>-86.1250</td>
    </tr>
    <tr>
      <th>1022</th>
      <td>107.987297</td>
      <td>-127.0</td>
      <td>-72.5</td>
      <td>-86.3125</td>
    </tr>
  </tbody>
</table>
<p>1023 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Para filtrarmos os dados estatísticos relativo a um tempo específico, precisamos saber de antemão qual o período específico o arquivo <code>.bin</code> compreende, se passarmos um período de tempo inválido, é retornado um DataFrame vazio e uma mensagem de aviso é salva no log.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">time_start</span><span class="o">=</span><span class="s1">&#39;2021-05-21&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[14:35:29] </span><span style="color: #800000; text-decoration-color: #800000">WARNING </span> Os parâmetros repassados não           <a href="file://<ipython-input-21-d7e0253828b8>"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">&lt;ipython-input-21-d7e0253828b8&gt;</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:42</span>
                    correspondem a nenhum dado espectral                                     
                    do arquivo                                                               
                    <span style="color: #800080; text-decoration-color: #800080; font-style: italic">None</span>Type: <span style="color: #800080; text-decoration-color: #800080; font-style: italic">None</span>                                                           
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">time_stop</span><span class="o">=</span><span class="s1">&#39;2020-05-12&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[14:36:24] </span><span style="color: #800000; text-decoration-color: #800000">WARNING </span> Os parâmetros repassados não           <a href="file://<ipython-input-21-d7e0253828b8>"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">&lt;ipython-input-21-d7e0253828b8&gt;</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:42</span>
                    correspondem a nenhum dado espectral                                     
                    do arquivo                                                               
                    <span style="color: #800080; text-decoration-color: #800080; font-style: italic">None</span>Type: <span style="color: #800080; text-decoration-color: #800080; font-style: italic">None</span>                                                           
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Esse arquivo específico compreende o período de <code>Timestamp('2020-12-01 15:34:21.578869') a Timestamp('2020-12-01 16:13:53.920250')</code>, um período de menos de uma hora.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Basta passarmos uma string de data válida, as horas, minutos e segundos são opcionais.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">time_start</span><span class="o">=</span><span class="s1">&#39;2020-12-01 16:00&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70.000000</td>
      <td>-125.5</td>
      <td>-76.5</td>
      <td>-86.5000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70.019539</td>
      <td>-126.5</td>
      <td>-75.0</td>
      <td>-86.9375</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70.039085</td>
      <td>-129.5</td>
      <td>-76.5</td>
      <td>-86.6875</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.058624</td>
      <td>-137.0</td>
      <td>-76.5</td>
      <td>-86.6250</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.078163</td>
      <td>-127.0</td>
      <td>-75.5</td>
      <td>-86.6250</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>109.921837</td>
      <td>-130.5</td>
      <td>-72.5</td>
      <td>-87.0625</td>
    </tr>
    <tr>
      <th>2044</th>
      <td>109.941376</td>
      <td>-122.5</td>
      <td>-65.5</td>
      <td>-83.6250</td>
    </tr>
    <tr>
      <th>2045</th>
      <td>109.960915</td>
      <td>-124.5</td>
      <td>-65.5</td>
      <td>-84.0625</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>109.980461</td>
      <td>-129.0</td>
      <td>-67.0</td>
      <td>-83.2500</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>110.000000</td>
      <td>-113.5</td>
      <td>-66.5</td>
      <td>-82.2500</td>
    </tr>
  </tbody>
</table>
<p>2048 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">time_start</span><span class="o">=</span><span class="s1">&#39;01/12/2020 16:00&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70.000000</td>
      <td>-129.5</td>
      <td>-68.0</td>
      <td>-86.3125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70.019539</td>
      <td>-127.5</td>
      <td>-67.5</td>
      <td>-86.7500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70.039085</td>
      <td>-132.0</td>
      <td>-69.5</td>
      <td>-86.5625</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.058624</td>
      <td>-137.0</td>
      <td>-69.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.078163</td>
      <td>-130.0</td>
      <td>-70.0</td>
      <td>-86.4375</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>109.921837</td>
      <td>-130.5</td>
      <td>-64.0</td>
      <td>-87.1875</td>
    </tr>
    <tr>
      <th>2044</th>
      <td>109.941376</td>
      <td>-125.0</td>
      <td>-61.0</td>
      <td>-83.7500</td>
    </tr>
    <tr>
      <th>2045</th>
      <td>109.960915</td>
      <td>-129.5</td>
      <td>-60.0</td>
      <td>-84.0625</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>109.980461</td>
      <td>-129.0</td>
      <td>-59.5</td>
      <td>-83.2500</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>110.000000</td>
      <td>-131.5</td>
      <td>-60.0</td>
      <td>-82.1875</td>
    </tr>
  </tbody>
</table>
<p>2048 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> <span class="n">time_stop</span><span class="o">=</span><span class="s1">&#39;2020-12-01 16:00&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>70.000000</td>
      <td>-129.5</td>
      <td>-68.0</td>
      <td>-86.1875</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70.019539</td>
      <td>-127.5</td>
      <td>-67.5</td>
      <td>-86.6250</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70.039085</td>
      <td>-132.0</td>
      <td>-69.5</td>
      <td>-86.5000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.058624</td>
      <td>-129.5</td>
      <td>-69.0</td>
      <td>-86.3125</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.078163</td>
      <td>-130.0</td>
      <td>-70.0</td>
      <td>-86.3750</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>109.921837</td>
      <td>-128.0</td>
      <td>-64.0</td>
      <td>-87.2500</td>
    </tr>
    <tr>
      <th>2044</th>
      <td>109.941376</td>
      <td>-125.0</td>
      <td>-61.0</td>
      <td>-83.8750</td>
    </tr>
    <tr>
      <th>2045</th>
      <td>109.960915</td>
      <td>-129.5</td>
      <td>-60.0</td>
      <td>-84.1250</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>109.980461</td>
      <td>-125.5</td>
      <td>-59.5</td>
      <td>-83.1875</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>110.000000</td>
      <td>-131.5</td>
      <td>-60.0</td>
      <td>-82.1250</td>
    </tr>
  </tbody>
</table>
<p>2048 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Se quisermos filtrar para constar somente a faixa de FM e somente os 15 minutos de 15:45 a 16:00 do dia 01/12/2020</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="n">extract_bin_stats</span><span class="p">(</span><span class="n">binfile</span><span class="p">,</span> 
                          <span class="n">time_start</span><span class="o">=</span><span class="s1">&#39;01/12/2020 15:45&#39;</span><span class="p">,</span>
                          <span class="n">time_stop</span><span class="o">=</span><span class="s1">&#39;2020-12-01 16:00&#39;</span><span class="p">,</span>
                          <span class="n">freq_start</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span>
                          <span class="n">freq_stop</span><span class="o">=</span><span class="mi">108</span><span class="p">)</span> 
<span class="n">dados</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>88.016609</td>
      <td>-111.5</td>
      <td>-49.0</td>
      <td>-83.9375</td>
    </tr>
    <tr>
      <th>1</th>
      <td>88.036148</td>
      <td>-117.5</td>
      <td>-48.5</td>
      <td>-84.0625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>88.055695</td>
      <td>-116.5</td>
      <td>-49.0</td>
      <td>-83.8125</td>
    </tr>
    <tr>
      <th>3</th>
      <td>88.075233</td>
      <td>-120.0</td>
      <td>-47.5</td>
      <td>-83.5625</td>
    </tr>
    <tr>
      <th>4</th>
      <td>88.094772</td>
      <td>-120.0</td>
      <td>-47.5</td>
      <td>-83.4375</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1018</th>
      <td>107.909134</td>
      <td>-122.0</td>
      <td>-65.5</td>
      <td>-85.3125</td>
    </tr>
    <tr>
      <th>1019</th>
      <td>107.928673</td>
      <td>-120.0</td>
      <td>-66.5</td>
      <td>-85.5625</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>107.948219</td>
      <td>-126.5</td>
      <td>-67.5</td>
      <td>-85.8750</td>
    </tr>
    <tr>
      <th>1021</th>
      <td>107.967758</td>
      <td>-112.0</td>
      <td>-71.5</td>
      <td>-86.1875</td>
    </tr>
    <tr>
      <th>1022</th>
      <td>107.987297</td>
      <td>-127.0</td>
      <td>-72.5</td>
      <td>-86.3125</td>
    </tr>
  </tbody>
</table>
<p>1023 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

